"use strict";(self["webpackChunkstore"]=self["webpackChunkstore"]||[]).push([[405],{3405:function(t,e,a){a.r(e),a.d(e,{default:function(){return h}});var r=a(6768),s=a(4232);const c={class:"cart"},i={key:0,class:"total"},o={key:1};function l(t,e,a,l,n,u){const d=(0,r.g2)("a-list-item-meta"),h=(0,r.g2)("a-button"),m=(0,r.g2)("a-list-item"),g=(0,r.g2)("a-list");return(0,r.uX)(),(0,r.CE)("div",c,[e[3]||(e[3]=(0,r.Lk)("h1",null,"Корзина",-1)),(0,r.bF)(g,{bordered:"","data-source":n.cart},{renderItem:(0,r.k6)((({item:t})=>[(0,r.bF)(m,null,{default:(0,r.k6)((()=>[(0,r.bF)(d,{title:t.name,description:t.description},null,8,["title","description"]),(0,r.Lk)("div",null,[(0,r.Lk)("strong",null,(0,s.v_)(t.price)+" ₽",1),(0,r.bF)(h,{danger:"",size:"small",onClick:e=>u.removeItem(t.id),style:{"margin-left":"16px"}},{default:(0,r.k6)((()=>e[0]||(e[0]=[(0,r.eW)(" Удалить ")]))),_:2},1032,["onClick"])])])),_:2},1024)])),_:1},8,["data-source"]),n.cart.length?((0,r.uX)(),(0,r.CE)("div",i,[(0,r.Lk)("p",null,[e[1]||(e[1]=(0,r.eW)("Итого: ")),(0,r.Lk)("strong",null,(0,s.v_)(u.total)+" ₽",1)]),(0,r.bF)(h,{type:"primary",size:"large",onClick:u.checkout},{default:(0,r.k6)((()=>e[2]||(e[2]=[(0,r.eW)(" Оформить заказ ")]))),_:1},8,["onClick"])])):((0,r.uX)(),(0,r.CE)("p",o,"Корзина пуста."))])}a(8111),a(2489),a(8237);var n={name:"CartPage",data(){return{cart:[]}},computed:{total(){return this.cart.reduce(((t,e)=>t+e.price),0)}},created(){const t=localStorage.getItem("cart");t&&(this.cart=JSON.parse(t))},methods:{removeItem(t){this.cart=this.cart.filter((e=>e.id!==t)),localStorage.setItem("cart",JSON.stringify(this.cart)),this.$message.info("Товар удалён из корзины")},async checkout(){if(0===this.cart.length)return void this.$message.warning("Корзина пуста!");const t={items:this.cart,total:this.total};console.log("Отправка заказа:",t);try{const e=await fetch("http://localhost:5000/api/order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await e.json();a.success?(this.$message.success(`✅ Заказ оформлен! Сумма: ${this.total} ₽`),this.cart=[],localStorage.removeItem("cart")):this.$message.error("Ошибка оформления заказа. Попробуйте снова.")}catch(e){this.$message.error("Ошибка при отправке заказа. Попробуйте позже.")}}}},u=a(1241);const d=(0,u.A)(n,[["render",l],["__scopeId","data-v-3faec763"]]);var h=d}}]);
//# sourceMappingURL=405.09cbc7a9.js.map